<div class="ocaml_toplevel_module"><div class="info">This is a port of Bram Cohen's patience diff algorithm, as found in the Bazaar 1.14.1
    source code, available at http://bazaar-vcs.org.<br/>    This copyright notice was included:<br/>    # Copyright (C) 2005 Bram Cohen, Copyright (C) 2005, 2006 Canonical Ltd
    #
    # This program is free software; you can redistribute it and/or modify
    # it under the terms of the GNU General Public License as published by
    # the Free Software Foundation; either version 2 of the License, or
    # (at your option) any later version.
    #
    # This program is distributed in the hope that it will be useful,
    # but WITHOUT ANY WARRANTY; without even the implied warranty of
    # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    # GNU General Public License for more details.
    #
    # You should have received a copy of the GNU General Public License
    # along with this program; if not, write to the Free Software
    # Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</div>
<div class="ocaml_module sig" name="Matching_block"><pre><span class="keyword">module</span> <a href="?package=core_extended&amp;module=Patience_diff.Matching_block">Matching_block</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="info"><div class="info">Bram Cohen's comment from the original Python code (with syntax changed to OCaml):<br/>    <code class="code">get_matching_blocks a b</code> returns a list of triples describing matching
    subsequences.<br/>    Each triple is of the form (i, j, n), and means that
    a &lt;|&gt; (i,i+n) = b &lt;|&gt; (j,j+n).  The triples are monotonically increasing in
    i and in j.<br/>    The last triple is a dummy, (Array.length a, Array.length b, 0), and is the only
    triple with n=0.<br/>    Example:
    get_matching_blocks <code class="code">|&quot;a&quot;;&quot;b&quot;;&quot;x&quot;;&quot;c&quot;;&quot;d&quot;|</code> <code class="code">|&quot;a&quot;;&quot;b&quot;;&quot;c&quot;;&quot;d&quot;|</code>
    returns
    <code class="code">(0, 0, 2), (3, 2, 2), (5, 4, 0)</code></div></div><div class="ocaml_module_content">
<pre><code><span class="TYPEt"><span class="keyword">type</span> t</span> = {</code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.mine_start">mine_start</span> : <code class="type">int</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.other_start">other_start</span> : <code class="type">int</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.length">length</span> : <code class="type">int</code>;</code></td></tr><tr><td>}</td></tr></table></div></div>
<pre><span class="VALget_matching_blocks"><span class="keyword">val</span> get_matching_blocks</span> : <code class="type">transform:('a -&gt; 'b) -&gt;
compare:('b -&gt; 'b -&gt; int) -&gt;
mine:'a array -&gt; other:'a array -&gt; <a href="?package=core_extended&amp;module=Patience_diff.Matching_block&amp;type=t">Matching_block.t</a> list</code></pre>
<pre><span class="VALratio"><span class="keyword">val</span> ratio</span> : <code class="type">'a array -&gt; 'a array -&gt; float</code></pre>
<div class="ocaml_module sig" name="Range"><pre><span class="keyword">module</span> <a href="?package=core_extended&amp;module=Patience_diff.Range">Range</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="info"><div class="info">For handling diffs abstractly.  A range is a subarray of the two original
    arrays with a constructor defining its relationship to the two original
    arrays.  A <code class="code">Same</code> range contains a series of elements which can be found in
    both arrays.  A <code class="code">New</code> range contains elements found only in the new array,
    while an <code class="code">Old</code> range contains elements found only in the old array.<br/>    A <code class="code">Replace</code> contains two arrays: elements in the first array are elements
    found only in the original, old array which have been replaced by elements
    in the second array, which are elements found only in the new array.</div></div><div class="ocaml_module_content">
<pre><code><span class="TYPEt"><span class="keyword">type</span> <code class="type">'a </code>t</span> = </code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.Same"><span class="constructor">Same</span></span> <span class="keyword">of</span> <code class="type">('a * 'a) array</code></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.Old"><span class="constructor">Old</span></span> <span class="keyword">of</span> <code class="type">'a array</code></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.New"><span class="constructor">New</span></span> <span class="keyword">of</span> <code class="type">'a array</code></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.Replace"><span class="constructor">Replace</span></span> <span class="keyword">of</span> <code class="type">'a array * 'a array</code></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.Unified"><span class="constructor">Unified</span></span> <span class="keyword">of</span> <code class="type">'a array</code></code></td><td class="typefieldcomment" align="left"><div class="info"><code class="code">ranges_all_same ranges</code> returns true if all <code class="code">ranges</code> are Same</div></td></tr></table>
<pre><span class="VALall_same"><span class="keyword">val</span> all_same</span> : <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff.Range&amp;type=t">t</a> list -&gt; bool</code></pre>
<pre><span class="VALold_only"><span class="keyword">val</span> old_only</span> : <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff.Range&amp;type=t">t</a> list -&gt; 'a <a href="?package=core_extended&amp;module=Patience_diff.Range&amp;type=t">t</a> list</code></pre><div class="info"><div class="info"><code class="code">old_only hunks</code> drops all New ranges and converts all Replace
      ranges to Old ranges.</div></div>
<pre><span class="VALnew_only"><span class="keyword">val</span> new_only</span> : <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff.Range&amp;type=t">t</a> list -&gt; 'a <a href="?package=core_extended&amp;module=Patience_diff.Range&amp;type=t">t</a> list</code></pre><div class="info"><div class="info"><code class="code">new_only hunks</code> drops all Old ranges and converts all Replace
    ranges to New ranges.</div></div>
<pre><span class="VALt_of_sexp"><span class="keyword">val</span> t_of_sexp</span> : <code class="type">(<a href="?package=sexplib&amp;module=Sexp&amp;type=t">Sexplib.Sexp.t</a> -&gt; 'a) -&gt; <a href="?package=sexplib&amp;module=Sexp&amp;type=t">Sexplib.Sexp.t</a> -&gt; 'a <a href="?package=core_extended&amp;module=Patience_diff.Range&amp;type=t">t</a></code></pre>
<pre><span class="VALsexp_of_t"><span class="keyword">val</span> sexp_of_t</span> : <code class="type">('a -&gt; <a href="?package=sexplib&amp;module=Sexp&amp;type=t">Sexplib.Sexp.t</a>) -&gt; 'a <a href="?package=core_extended&amp;module=Patience_diff.Range&amp;type=t">t</a> -&gt; <a href="?package=sexplib&amp;module=Sexp&amp;type=t">Sexplib.Sexp.t</a></code></pre><div class="info"><div class="info"><code class="code">ranges_all_same ranges</code> returns true if all <code class="code">ranges</code> are Same</div></div>
<div class="info"><div class="info"><code class="code">old_only hunks</code> drops all New ranges and converts all Replace
      ranges to Old ranges.</div></div>
<div class="info"><div class="info"><code class="code">new_only hunks</code> drops all Old ranges and converts all Replace
    ranges to New ranges.</div></div></div></div>
<div class="ocaml_module sig" name="Hunk"><pre><span class="keyword">module</span> <a href="?package=core_extended&amp;module=Patience_diff.Hunk">Hunk</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="info"><div class="info">In diff terms, a hunk is a unit of consecutive ranges with some <code class="code">Same</code>
    context before and after <code class="code">New</code>, <code class="code">Old</code>, and <code class="code">Replace</code> ranges.  Each
    hunk contains information about the original arrays, specifically the
    starting indexes and the number of elements in both arrays to which
    the hunk refers.<br/>    Furthermore, a diff is essentially a list of hunks.  The simplest case
    is a diff with infinite context, consisting of exactly one hunk.</div></div><div class="ocaml_module_content">
<pre><code><span class="TYPEt"><span class="keyword">type</span> <code class="type">'a </code>t</span> = {</code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.mine_start">mine_start</span> : <code class="type">int</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.mine_size">mine_size</span> : <code class="type">int</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.other_start">other_start</span> : <code class="type">int</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.other_size">other_size</span> : <code class="type">int</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.ranges">ranges</span> : <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff.Range&amp;type=t">Range.t</a> list</code>;</code></td></tr><tr><td>}</td></tr></table>
<pre><span class="VALall_same"><span class="keyword">val</span> all_same</span> : <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">t</a> -&gt; bool</code></pre><div class="info"><div class="info"><code class="code">all_same hunk</code> returns true if <code class="code">hunk</code> contains only Same ranges.</div></div></div></div>
<pre><span class="VALget_hunks"><span class="keyword">val</span> get_hunks</span> : <code class="type">transform:('a -&gt; 'b) -&gt;
compare:('b -&gt; 'b -&gt; int) -&gt;
context:int -&gt; mine:'a array -&gt; other:'a array -&gt; 'a <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">Hunk.t</a> list</code></pre><div class="info"><div class="info"><code class="code">get_hunks a b ~context ~compare</code> will compare the arrays <code class="code">a</code> and <code class="code">b</code> using
    <code class="code">compare</code> and produce a list of hunks. (The hunks will contain Same ranges
    of at most <code class="code">context</code> elements.)  <code class="code">context</code> defaults to infinity (producing a
    singleton hunk list), <code class="code">compare</code> defaults to polymorphic compare.</div></div>
<pre><span class="VALprint_ranges"><span class="keyword">val</span> print_ranges</span> : <code class="type">string <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">Hunk.t</a> -&gt; unit</code></pre>
<pre><span class="VALall_same"><span class="keyword">val</span> all_same</span> : <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">Hunk.t</a> list -&gt; bool</code></pre><div class="info"><div class="info"><code class="code">get_status hunks</code> returns `Same if each hunk in <code class="code">hunks</code> has only Same ranges.</div></div>
<pre><span class="VALunified"><span class="keyword">val</span> unified</span> : <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">Hunk.t</a> list -&gt; 'a <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">Hunk.t</a> list</code></pre><div class="info"><div class="info"><code class="code">unified hunks</code> converts all Replace ranges in hunks to an Old range
    followed by a New range.</div></div>
<pre><span class="VALold_only"><span class="keyword">val</span> old_only</span> : <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">Hunk.t</a> list -&gt; 'a <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">Hunk.t</a> list</code></pre><div class="info"><div class="info"><code class="code">old_only hunks</code> drops all New ranges from hunks and converts all Replace
    ranges to Old ranges.</div></div>
<pre><span class="VALnew_only"><span class="keyword">val</span> new_only</span> : <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">Hunk.t</a> list -&gt; 'a <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">Hunk.t</a> list</code></pre><div class="info"><div class="info"><code class="code">new_only hunks</code> drops all Old ranges from hunks and converts all Replace
    ranges to New ranges.</div></div>
<pre><span class="VALranges"><span class="keyword">val</span> ranges</span> : <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff.Hunk&amp;type=t">Hunk.t</a> list -&gt; 'a <a href="?package=core_extended&amp;module=Patience_diff.Range&amp;type=t">Range.t</a> list</code></pre><div class="info"><div class="info"><code class="code">ranges hunks</code> concatenates all the ranges of all hunks together *</div></div>
<pre><code><span class="TYPEsegment"><span class="keyword">type</span> <code class="type">'a </code>segment</span> = </code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTsegment.Same"><span class="constructor">Same</span></span> <span class="keyword">of</span> <code class="type">'a array</code></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTsegment.Different"><span class="constructor">Different</span></span> <span class="keyword">of</span> <code class="type">'a array array</code></code></td></tr></table>
<pre><span class="TYPEmerged_array"><span class="keyword">type</span> <code class="type">'a </code>merged_array</span> = <code class="type">'a <a href="?package=core_extended&amp;module=Patience_diff&amp;type=segment">segment</a> list</code></pre>
<pre><span class="VALmerge"><span class="keyword">val</span> merge</span> : <code class="type">'a array array -&gt; 'a <a href="?package=core_extended&amp;module=Patience_diff&amp;type=merged_array">merged_array</a></code></pre>
</div>