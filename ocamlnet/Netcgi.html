<div class="ocaml_toplevel_module"><div class="info">Common data-structures for CGI-like connectors.<p> This library tries to minimize the use of unsafe practices.  It
 cannot be bullet proof however and you should read about
  <a href="http://www.w3.org/Security/Faq/wwwsf4.html">security</a>.</p><p> REMARK: It happens frequently that hard to predict random numbers
 are needed in Web applications.  The previous version of this
 library used to include some facilities for that (in the
 <code class="code">Netcgi_jserv</code> module).  They have been dropped in favor of
  <a href="http://pauillac.inria.fr/~xleroy/software.html#cryptokit">Cryptokit</a>.</p></div>
<div class="info"><div class="info"><h2 id="2_TITLE">Arguments</h2></div></div>
<div class="ocaml_class sig" name="cgi_argument"><pre><span class="TYPEcgi_argument"><span class="keyword">class type</span> <a href="?package=ocamlnet&amp;module=Netcgi&amp;class=cgi_argument">cgi_argument</a></span> : <code class="code">object</code> .. <code class="code">end</code></pre><div class="info"><div class="info">Represent a key-value pair of data passed to the script (including
    file uploads).</div></div><div class="ocaml_class_content"><pre><span class="METHODname"><span class="keyword">method</span> name</span> : <code class="code">string</code></pre>
<div class="info"><div class="info">The name of the argument.</div></div>
<pre><span class="METHODvalue"><span class="keyword">method</span> value</span> : <code class="code">string</code></pre>
<div class="info"><div class="info">The value of the argument, after all transfer encodings have
        been removed.  If the value is stored in a file, the file will
        be loaded. <b>Raises</b> <code>Argument.Oversized</code> if the argument was discarded.<br/><code>Failure</code> if the object has been finalized.<br/></div></div>
<pre><span class="METHODopen_value_rd"><span class="keyword">method</span> open_value_rd</span> : <code class="code">unit -&gt; <a href="?package=ocamlnet&amp;module=Netchannels&amp;type=in_obj_channel">Netchannels.in_obj_channel</a></code></pre>
<div class="info"><div class="info">Open the contents of the value as an input channel.  This
        works for all kinds of arguments, regardless of their
        <code class="code">#storage</code> and <code class="code">#representation</code>. <b>Raises</b> <code>Argument.Oversized</code> if the argument was discarded.<br/><code>Failure</code> if the object has been finalized.<br/></div></div>
<pre><span class="METHODstore"><span class="keyword">method</span> store</span> : <code class="code">[ `File of string | `Memory ]</code></pre>
<div class="info"><div class="info">Tells whether the argument is stored in memory (as a string)
        or as a file (the argument of <code class="code">`File</code> being the filename).</div></div>
<pre><span class="METHODcontent_type"><span class="keyword">method</span> content_type</span> : <code class="code">unit -&gt; string * (string * <a href="?package=ocamlnet&amp;module=Mimestring&amp;type=s_param">Mimestring.s_param</a>) list</code></pre>
<div class="info"><div class="info">Returns the content type of the header and its parameters as a
	couple <code class="code">(hdr, params)</code>.  When the header is missing, the
	result is <code class="code">(&quot;text/plain&quot;, [])</code>.  Below you will find access
	method for frequently used parameters.</div></div>
<pre><span class="METHODcharset"><span class="keyword">method</span> charset</span> : <code class="code">string</code></pre>
<div class="info"><div class="info">The <code class="code">charset</code> parameter of the content type of the header, or
        <code class="code">&quot;&quot;</code> when there is no such parameter, or no header.</div></div>
<pre><span class="METHODfilename"><span class="keyword">method</span> filename</span> : <code class="code">string option</code></pre>
<div class="info"><div class="info">The <code class="code">filename</code> parameter found in the header of file uploads.
        When present, <code class="code">Some name</code> is returned, and <code class="code">None</code> otherwise.
        (This is not to be confused with the possible local file
        holding the data.)</div></div>
<pre><span class="METHODrepresentation"><span class="keyword">method</span> representation</span> : <code class="code">[ `MIME of <a href="?package=ocamlnet&amp;module=Netmime&amp;type=mime_message">Netmime.mime_message</a> | `Simple of <a href="?package=ocamlnet&amp;module=Netmime&amp;type=mime_body">Netmime.mime_body</a> ]</code></pre>
<div class="info"><div class="info">The representation of the argument.<p>        - <code class="code">`Simple</code> the value of the CGI argument is an unstructured
          string value.</p><ul><li><code class="code">`MIME</code> The argument has a MIME header in addition to the
          value.  The MIME message is read-only.  </li></ul></div></div>
<pre><span class="METHODfinalize"><span class="keyword">method</span> finalize</span> : <code class="code">unit -&gt; unit</code></pre>
<div class="info"><div class="info">Arguments stored in temp files must be deleted when the
        argument is no longer used. You can call <code class="code">finalize</code> to delete
        such files.  The method does not have any effect when <code class="code">store =
        `Memory</code>.  The method never raises any exceptions.  If the
        file no longer exists (e.g. because it was moved away) or if
        there are any problems deleting the file, the error will be
        ignored.<p>        The <code class="code">finalize</code> method is not registered in the garbage
        collector.  You can do that, but it is usually better to call
        this method manually.</p></div></div></div></div>
<div class="ocaml_module sig" name="Argument"><pre><span class="keyword">module</span> <a href="?package=ocamlnet&amp;module=Netcgi.Argument">Argument</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="info"><div class="info">Operations on arguments and lists of thereof.</div></div><div class="ocaml_module_content">
<pre><span class="EXCEPTIONOversized"><span class="keyword">exception</span> Oversized</span></pre>
<pre><span class="VALsimple"><span class="keyword">val</span> simple</span> : <code class="type">string -&gt; string -&gt; <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a></code></pre><div class="info"><div class="info"><code class="code">simple_arg name value</code> creates an unstructured CGI argument
	called <code class="code">name</code> with contents <code class="code">value</code>.</div></div>
<pre><span class="VALmime"><span class="keyword">val</span> mime</span> : <code class="type">?work_around_backslash_bug:bool -&gt;
?name:string -&gt; <a href="?package=ocamlnet&amp;module=Netmime&amp;type=mime_message">Netmime.mime_message</a> -&gt; <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a></code></pre><div class="info"><div class="info"><code class="code">mime_arg ?name msg</code> creates a MIME-structured CGI argument
	called <code class="code">name</code> with contents <code class="code">msg</code>.  You can create <code class="code">msg</code> by
	either  <a href="#Netmime.memory_mime_message">Netmime.memory_mime_message</a> or
	 <a href="#Netmime.file_mime_message">Netmime.file_mime_message</a>.<div class="parameters"><div class="param_info"><code class="code">name</code> : set the name of the argument.  If it is not given,
	the name is extracted from the &quot;Content-Disposition&quot; field of
	the <code class="code">msg</code> header or it <code class="code">&quot;&quot;</code> if this field is not found.</div><div class="param_info"><code class="code">work_around_backslash_bug</code> : Whether to work around a bug
	found in almost all browsers regarding the treatment of
	backslashes.  The browsers do not quote backslashes in file
	names.  This breaks RFC standards, however.  This argument is
	<code class="code">true</code> by default.</div></div></div></div>
<div class="info"><div class="info">It is easy to manipulate lists of arguments with the <code class="code">List</code>
      module.  For example, <code class="code">List.filter (fun a -&gt; a#name &lt;&gt; n) args</code>
      will remove from <code class="code">args</code> all occurrences of the argument with
      name <code class="code">n</code>.  The following functions are helpers for operations
      specific to arguments.</div></div>
<pre><span class="VALclone"><span class="keyword">val</span> clone</span> : <code class="type">?name:string -&gt;
?value:string -&gt; ?msg:<a href="?package=ocamlnet&amp;module=Netmime&amp;type=mime_message">Netmime.mime_message</a> -&gt; <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a> -&gt; <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a></code></pre>
<pre><span class="VALset"><span class="keyword">val</span> set</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a> list -&gt; <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a> list -&gt; <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a> list</code></pre><div class="info"><div class="info"><code class="code">set new_args args</code> creates a list of argument from <code class="code">args</code>
	deleting the arguments whose name appears in <code class="code">new_args</code> and
	adding the <code class="code">new_args</code> arguments.</div></div></div></div>
<div class="ocaml_class sig" name="rw_cgi_argument"><pre><span class="TYPErw_cgi_argument"><span class="keyword">class type</span> <a href="?package=ocamlnet&amp;module=Netcgi&amp;class=rw_cgi_argument">rw_cgi_argument</a></span> : <code class="code">object</code> .. <code class="code">end</code></pre><div class="info"><div class="info">Old deprecated writable argument type.<span class="warning">Deprecated.</span> Arguments are read-only.<br/></div></div><div class="ocaml_class_content"><div class="ocaml_class ident" name="_inherit_field" path="?package=ocamlnet&amp;module=Netcgi&amp;class=cgi_argument"> <pre><span class="keyword">inherit</span> <code class="type"/><a href="?package=ocamlnet&amp;module=Netcgi&amp;class=cgi_argument">cgi_argument</a></pre></div>

<pre><span class="METHODro"><span class="keyword">method</span> ro</span> : <code class="code">bool</code></pre>

<pre><span class="METHODset_value"><span class="keyword">method</span> set_value</span> : <code class="code">string -&gt; unit</code></pre>

<pre><span class="METHODopen_value_wr"><span class="keyword">method</span> open_value_wr</span> : <code class="code">unit -&gt; <a href="?package=ocamlnet&amp;module=Netchannels&amp;type=out_obj_channel">Netchannels.out_obj_channel</a></code></pre>
</div></div>
<div class="ocaml_class ident" name="simple_argument" path="?package=ocamlnet&amp;module=Netcgi&amp;class=rw_cgi_argument"><pre><span class="TYPEsimple_argument"><span class="keyword">class</span> <a href="?package=ocamlnet&amp;module=Netcgi&amp;class=simple_argument">simple_argument</a></span> : <code class="type">bool option -&gt; string -&gt; string -&gt; </code><a href="?package=ocamlnet&amp;module=Netcgi&amp;class=rw_cgi_argument">rw_cgi_argument</a></pre><div class="info"><div class="info">Old deprecated simple argument class.<span class="warning">Deprecated.</span> Use  <a href="#Netcgi.Argument.simple">Netcgi.Argument.simple</a> instead.<br/></div></div></div>
<div class="ocaml_class ident" name="mime_argument" path="?package=ocamlnet&amp;module=Netcgi&amp;class=rw_cgi_argument"><pre><span class="TYPEmime_argument"><span class="keyword">class</span> <a href="?package=ocamlnet&amp;module=Netcgi&amp;class=mime_argument">mime_argument</a></span> : <code class="type">bool option -&gt; string -&gt; <a href="?package=ocamlnet&amp;module=Netmime&amp;type=mime_message">Netmime.mime_message</a> -&gt; </code><a href="?package=ocamlnet&amp;module=Netcgi&amp;class=rw_cgi_argument">rw_cgi_argument</a></pre><div class="info"><div class="info">Old deprecated MIME argument class.<span class="warning">Deprecated.</span> Use  <a href="#Netcgi.Argument.mime">Netcgi.Argument.mime</a> instead.<br/></div></div></div>
<div class="info"><div class="info"><h2 id="2_TITLE">Cookies</h2></div></div>
<div class="ocaml_module sig" name="Cookie"><pre><span class="keyword">module</span> <a href="?package=ocamlnet&amp;module=Netcgi.Cookie">Cookie</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="info"><div class="info">Functions to manipulate cookies.<p>    You should know that besides the <code class="code">name</code> and <code class="code">value</code> attribute,
    user agents will send at most the <code class="code">path</code>, <code class="code">domain</code> and <code class="code">port</code> and
    usually will not send them at all.</p><p>    For interoperability, cookies are set using version 0 (by
    Netscape) unless version 1 (RFC 2965 and the older RFC 2109)
    fields are set.  While version 0 is well supported by browsers,
    RFC 2109 requires a recent browser and RFC 2965 is usually not
    supported.  You do not have to worry however, cookies are always
    sent in such a way older browsers understand them -- albeit not
    all attributes of course -- so your application can be ready for
    the time RFC 2965 will be the norm.</p><p>    N.B. This module appears also as  <a href="#Nethttp.Cookie">Nethttp.Cookie</a>.</p></div></div><div class="ocaml_module_content">
<pre><span class="TYPEt"><span class="keyword">type</span> t</span> = <code class="type"><a href="?package=ocamlnet&amp;module=Nethttp.Cookie&amp;type=t">Nethttp.Cookie.t</a></code></pre><div class="info"><div class="info">Mutable cookie type.</div></div>
<pre><span class="VALmake"><span class="keyword">val</span> make</span> : <code class="type">?max_age:int -&gt;
?domain:string -&gt;
?path:string -&gt;
?secure:bool -&gt;
?comment:string -&gt;
?comment_url:string -&gt; ?ports:int list -&gt; string -&gt; string -&gt; <a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a></code></pre><div class="info"><div class="info"><code class="code">make ?expires ?domain ?path ?secure name value</code> creates a new
        cookie with name <code class="code">name</code> holding <code class="code">value</code>.<div class="parameters"><div class="param_info"><code class="code">max_age</code> : see  <a href="#Netcgi.Cookie.set_max_age">Netcgi.Cookie.set_max_age</a>.
                       Default: when user agent exits.</div><div class="param_info"><code class="code">domain</code> : see  <a href="#Netcgi.Cookie.set_domain">Netcgi.Cookie.set_domain</a>.
	              Default: hostname of the server.</div><div class="param_info"><code class="code">path</code> : see  <a href="#Netcgi.Cookie.set_path">Netcgi.Cookie.set_path</a>.
                    Default: script name + path_info.</div><div class="param_info"><code class="code">secure</code> : see  <a href="#Netcgi.Cookie.set_secure">Netcgi.Cookie.set_secure</a>.  Default: <code class="code">false</code>.</div><div class="param_info"><code class="code">comment</code> : see  <a href="#Netcgi.Cookie.set_comment">Netcgi.Cookie.set_comment</a>.  Default: <code class="code">&quot;&quot;</code>.</div><div class="param_info"><code class="code">comment_url</code> : see  <a href="#Netcgi.Cookie.set_comment_url">Netcgi.Cookie.set_comment_url</a>.
	                   Default: <code class="code">&quot;&quot;</code>.</div><div class="param_info"><code class="code">ports</code> : see  <a href="#Netcgi.Cookie.set_ports">Netcgi.Cookie.set_ports</a>.
	             Default: same port the cookie was sent.</div></div></div></div>
<pre><span class="VALname"><span class="keyword">val</span> name</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string</code></pre><div class="info"><div class="info">The name of the cookie.</div></div>
<pre><span class="VALvalue"><span class="keyword">val</span> value</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string</code></pre><div class="info"><div class="info">The value of the cookie.</div></div>
<pre><span class="VALdomain"><span class="keyword">val</span> domain</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string option</code></pre><div class="info"><div class="info">The domain of the cookie, if set.</div></div>
<pre><span class="VALpath"><span class="keyword">val</span> path</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string option</code></pre><div class="info"><div class="info">The path of the cookie, if set.</div></div>
<pre><span class="VALports"><span class="keyword">val</span> ports</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; int list option</code></pre><div class="info"><div class="info"><code class="code">port c</code> the ports to which the cookie may be returned or <code class="code">[]</code> if
	not set.</div></div>
<pre><span class="VALmax_age"><span class="keyword">val</span> max_age</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; int option</code></pre><div class="info"><div class="info">The expiration time of the cookie, in seconds.  <code class="code">None</code> means
        that the cookie will be discarded when the browser exits.
        This information is not returned by the browser.</div></div>
<pre><span class="VALsecure"><span class="keyword">val</span> secure</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; bool</code></pre><div class="info"><div class="info">Tells whether the cookie is secure.
        This information is not returned by the browser.</div></div>
<pre><span class="VALcomment"><span class="keyword">val</span> comment</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string</code></pre><div class="info"><div class="info">Returns the comment associated to the cookie or <code class="code">&quot;&quot;</code> if it
        does not exists.  This information is not returned by the
        browser.</div></div>
<pre><span class="VALcomment_url"><span class="keyword">val</span> comment_url</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string</code></pre><div class="info"><div class="info">Returns the comment URL associated to the cookie or <code class="code">&quot;&quot;</code> if it
        does not exists.  This information is not returned by the
        browser.</div></div>
<pre><span class="VALset_value"><span class="keyword">val</span> set_value</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string -&gt; unit</code></pre><div class="info"><div class="info"><code class="code">set_value c v</code> sets the value of the cookie <code class="code">c</code> to <code class="code">v</code>.</div></div>
<pre><span class="VALset_max_age"><span class="keyword">val</span> set_max_age</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; int option -&gt; unit</code></pre><div class="info"><div class="info"><code class="code">set_max_age c (Some t)</code> sets the lifetime of the cookie <code class="code">c</code>
        to <code class="code">t</code> seconds.  If <code class="code">t &lt;= 0</code>, it means that the cookie should
        be discarded immediately.  <code class="code">set_expires c None</code> tells the
        cookie to be discarded when the user agent exits.  (Despite
        the fact that the name is borrowed from the version 1 of the
        specification, it works transparently with version 0.)</div></div>
<pre><span class="VALset_domain"><span class="keyword">val</span> set_domain</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string option -&gt; unit</code></pre><div class="info"><div class="info">Cookies are bound to a certain domain, i.e. the browser sends
	them only when web pages of the domain are requested:<ul><li><code class="code">None</code>: the domain is the hostname of the server.</li><li><code class="code">Some domain</code>: the domain is <code class="code">domain</code>.  </li></ul></div></div>
<pre><span class="VALset_path"><span class="keyword">val</span> set_path</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string option -&gt; unit</code></pre><div class="info"><div class="info">Cookies are also bound to certain path prefixes, i.e. the
        browser sends them only when web pages at the path or below are
        requested.<ul><li><code class="code">None</code>: the path is script name + path_info</li><li><code class="code">Some p</code>: the path is <code class="code">p</code>. With <code class="code">Some &quot;/&quot;</code> you can disable the
          path restriction completely.  </li></ul></div></div>
<pre><span class="VALset_secure"><span class="keyword">val</span> set_secure</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; bool -&gt; unit</code></pre><div class="info"><div class="info">Cookies are also bound to the type of the web server:
        <code class="code">set_secure false</code> means servers without SSL, <code class="code">set_secure
        true</code> means servers with activated SSL (&quot;https&quot;).</div></div>
<pre><span class="VALset_comment"><span class="keyword">val</span> set_comment</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string -&gt; unit</code></pre><div class="info"><div class="info"><code class="code">set_comment c s</code> sets the comment of the cookie <code class="code">c</code> to <code class="code">s</code>
	which must be UTF-8 encoded (RFC 2279).  Because cookies can
	store personal information, the comment should describe how
	the cookie will be used so the client can decide whether to
	allow the cookie or not.  To cancel a comment, set it to <code class="code">&quot;&quot;</code>.<p>	Cookie version 1 (RFC 2109).</p></div></div>
<pre><span class="VALset_comment_url"><span class="keyword">val</span> set_comment_url</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; string -&gt; unit</code></pre><div class="info"><div class="info"><code class="code">set_comment_url c url</code> same as  <a href="#Netcgi.Cookie.set_comment">Netcgi.Cookie.set_comment</a>
	except that the cookie comment is available on the page
	pointed by <code class="code">url</code>.  To cancel, set it to <code class="code">&quot;&quot;</code>.<p>	Cookie version 1 (RFC 2965).</p></div></div>
<pre><span class="VALset_ports"><span class="keyword">val</span> set_ports</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; int list option -&gt; unit</code></pre><div class="info"><div class="info"><code class="code">set ports c (Some p)</code> says that the cookie <code class="code">c</code> must only be
	returned if the server request comes from one of the listed
	ports.  If <code class="code">p = []</code>, the cookie will only be sent to the
	request-port it was received from.  <code class="code">set_ports c None</code> says
	that the cookie may be sent to any port.<p>	Cookie version 1 (RFC 2965).</p></div></div>
<pre><span class="VALof_netscape_cookie"><span class="keyword">val</span> of_netscape_cookie</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Nethttp&amp;type=netscape_cookie">Nethttp.netscape_cookie</a> -&gt; <a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a></code></pre><div class="info"><div class="info">Convert a Netscape cookie to the new representation</div></div>
<pre><span class="VALto_netscape_cookie"><span class="keyword">val</span> to_netscape_cookie</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">t</a> -&gt; <a href="?package=ocamlnet&amp;module=Nethttp&amp;type=netscape_cookie">Nethttp.netscape_cookie</a></code></pre><div class="info"><div class="info">Convert to Netscape cookie (with information loss)</div></div></div></div>
<div class="info"><div class="info"><h2 id="2_TITLE">The environment of a request</h2></div></div>
<pre><span class="TYPEhttp_method"><span class="keyword">type</span> http_method</span> = <code class="type">[ `DELETE | `GET | `HEAD | `POST | `PUT ]</code></pre>
<pre><span class="TYPEconfig"><span class="keyword">type</span> config</span> = {<code class="type"><a href="?package=ocamlnet&amp;module=Netcgi_common&amp;type=config">Netcgi_common.config</a></code>}</pre><table class="typetable">
		    <tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTconfig.tmp_directory">tmp_directory</span> : <code class="type">string</code>;</code></td><td class="typefieldcomment" align="left"><div class="info">The directory where to create temporary files.  This should be
      an absolute path name.</div></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTconfig.tmp_prefix">tmp_prefix</span> : <code class="type">string</code>;</code></td><td class="typefieldcomment" align="left"><div class="info">The name prefix for temporary files. This must be a non-empty
      string. It must not contain '/'.</div></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTconfig.permitted_http_methods">permitted_http_methods</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=http_method">http_method</a> list</code>;</code></td><td class="typefieldcomment" align="left"><div class="info">The list of accepted HTTP methods</div></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTconfig.permitted_input_content_types">permitted_input_content_types</span> : <code class="type">string list</code>;</code></td><td class="typefieldcomment" align="left"><div class="info">The list of accepted content types in requests.
      Content type parameters (like &quot;charset&quot;) are ignored.
      If the list is empty, all content types are allowed.</div></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTconfig.input_content_length_limit">input_content_length_limit</span> : <code class="type">int</code>;</code></td><td class="typefieldcomment" align="left"><div class="info">The maximum size of the request, in bytes.</div></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTconfig.max_arguments">max_arguments</span> : <code class="type">int</code>;</code></td><td class="typefieldcomment" align="left"><div class="info">The maximum number of CGI arguments</div></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTconfig.workarounds">workarounds</span> : <code class="type">[ `Backslash_bug
| `MSIE_Content_type_bug
| `Work_around_MSIE_Content_type_bug
| `Work_around_backslash_bug ] list</code>;</code></td><td class="typefieldcomment" align="left"><div class="info">The list of enabled workarounds.<p>      - <code class="code">`MSIE_Content_type_bug</code></p><p>      - <code class="code">`Backslash_bug</code> A common error in MIME implementations is not
      to escape backslashes in quoted string and comments.  This
      workaround mandates that backslashes are handled as normal
      characters.  This is important for e.g. DOS filenames because,
      in the absence of this, the wrongly encoded &quot;C:\dir\file&quot; will
      be decoded as &quot;C:dirfile&quot;.</p><p>      Remark: <code class="code">`Work_around_MSIE_Content_type_bug</code> and
      <code class="code">`Work_around_backslash_bug</code> are deprecated versions of,
      respectively, <code class="code">`MSIE_Content_type_bug</code> and <code class="code">`Backslash_bug</code>.</p></div></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTconfig.default_exn_handler">default_exn_handler</span> : <code class="type">bool</code>;</code></td><td class="typefieldcomment" align="left"><div class="info">Whether to catch exceptions raised by the script and display an
      error page.  This will keep the connector running even if your
      program has bugs in some of its components.  This will however
      also prevent a stack trace to be printed; if you want this turn
      this option off.</div></td></tr><tr><td>}</td></tr></table>
<pre><span class="VALdefault_config"><span class="keyword">val</span> default_config</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=config">config</a></code></pre><div class="info"><div class="info">The default configuration is:<ul><li><code class="code">tmp_directory</code>:  <a href="#Netsys_tmp.tmp_directory()">Netsys_tmp.tmp_directory()</a></li><li><code class="code">tmp_prefix</code>: &quot;netcgi&quot;</li><li><code class="code">permitted_http_methods</code>: <code class="code">`GET</code>, <code class="code">`HEAD</code>, <code class="code">`POST</code>.</li><li><code class="code">permitted_input_content_types</code>: <code class="code">&quot;multipart/form-data&quot;</code>,
      <code class="code">&quot;application/x-www-form-urlencoded&quot;</code>.</li><li><code class="code">input_content_length_limit</code>: <code class="code">maxint</code> (i.e., no limit).</li><li><code class="code">max_arguments = 10000</code> (for security reasons)</li><li><code class="code">workarounds</code>: all of them.</li><li><code class="code">default_exn_handler</code>: set to <code class="code">true</code>.</li></ul>      To create a custom configuration, it is recommended to use this syntax:
      <code class="code">
      let custom_config = { default_config with tmp_prefix = &quot;my_prefix&quot; }
      </code>
      (This syntax is also robust w.r.t. the possible addition of new
      config flields.)</div></div>
<div class="ocaml_class sig" name="cgi_environment"><pre><span class="TYPEcgi_environment"><span class="keyword">class type</span> <a href="?package=ocamlnet&amp;module=Netcgi&amp;class=cgi_environment">cgi_environment</a></span> : <code class="code">object</code> .. <code class="code">end</code></pre><div class="info"><div class="info">The environment of a request consists of the information available
    besides the data sent by the user (as key-value pairs).</div></div><div class="ocaml_class_content"><div class="info"><div class="info"><h3 id="3_TITLE">CGI properties</h3><p>      The following properties are standardised by CGI.  The methods
      return <code class="code">&quot;&quot;</code> (or <code class="code">None</code> in the case of the port number) when the
      property is not available.</p></div></div>
<pre><span class="METHODcgi_gateway_interface"><span class="keyword">method</span> cgi_gateway_interface</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_server_name"><span class="keyword">method</span> cgi_server_name</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_server_port"><span class="keyword">method</span> cgi_server_port</span> : <code class="code">int option</code></pre>

<pre><span class="METHODcgi_server_protocol"><span class="keyword">method</span> cgi_server_protocol</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_server_software"><span class="keyword">method</span> cgi_server_software</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_request_method"><span class="keyword">method</span> cgi_request_method</span> : <code class="code">string</code></pre>
<div class="info"><div class="info">We recommend you to use the method  <a href="#Netcgi.cgi.request_method">Netcgi.cgi.request_method</a>
	which is more type-safe and informative.</div></div>
<pre><span class="METHODcgi_script_name"><span class="keyword">method</span> cgi_script_name</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_path_info"><span class="keyword">method</span> cgi_path_info</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_path_translated"><span class="keyword">method</span> cgi_path_translated</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_auth_type"><span class="keyword">method</span> cgi_auth_type</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_remote_addr"><span class="keyword">method</span> cgi_remote_addr</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_remote_host"><span class="keyword">method</span> cgi_remote_host</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_remote_user"><span class="keyword">method</span> cgi_remote_user</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_remote_ident"><span class="keyword">method</span> cgi_remote_ident</span> : <code class="code">string</code></pre>

<pre><span class="METHODcgi_query_string"><span class="keyword">method</span> cgi_query_string</span> : <code class="code">string</code></pre>
<div class="info"><div class="info">This is the row query string.  The  <a href="#Netcgi.cgi">Netcgi.cgi</a> class gives
	you an easy access to the arguments through the <code class="code">#arg...</code>
	methods.</div></div>
<pre><span class="METHODprotocol"><span class="keyword">method</span> protocol</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Nethttp&amp;type=protocol">Nethttp.protocol</a></code></pre>
<div class="info"><div class="info">The server protocol in a decoded form.  It can be either<ul><li><code class="code">`Http((major,minor),attributes)</code> or</li><li><code class="code">`Other</code>. </li></ul></div></div>
<pre><span class="METHODcgi_property"><span class="keyword">method</span> cgi_property</span> : <code class="code">?default:string -&gt; string -&gt; string</code></pre>
<div class="info"><div class="info">Returns a (possibly non-standard) CGI environment property.
        If the property is not set, <code class="code">Not_found</code> is be raised unless
        the <code class="code">default</code> argument is passed.  The <code class="code">default</code> argument
        determines the result of the function in this case.<p>        The method takes the case-sensitive name and returns the value
        of the property. Usually, these properties have uppercase
        names.</p><p>        For example, <code class="code">cgi_gateway_interface</code> returns the same as </p><code class="code">
        cgi_property ~default:&quot;&quot; &quot;GATEWAY_INTERFACE&quot; </code><p>        You cannot access the fields coming from the HTTP header.  Use
        the method <code class="code">input_header_field</code> instead.</p></div></div>
<pre><span class="METHODcgi_properties"><span class="keyword">method</span> cgi_properties</span> : <code class="code">(string * string) list</code></pre>
<div class="info"><div class="info">Return all properties as an associative list.</div></div>
<pre><span class="METHODcgi_https"><span class="keyword">method</span> cgi_https</span> : <code class="code">bool</code></pre>
<div class="info"><div class="info">A well-known extension is the HTTPS property.  It indicates
        whether a secure connection is used (SSL/TLS).  This method
        interprets this property and returns true if the connection is
        secure.  This method fails if there is a HTTPS property with
        an unknown value.</div></div>
<div class="info"><div class="info"><h3 id="3_TITLE">Header of the incoming HTTP request.</h3></div></div>
<pre><span class="METHODinput_header"><span class="keyword">method</span> input_header</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Netmime&amp;type=mime_header">Netmime.mime_header</a></code></pre>
<div class="info"><div class="info">The whole HTTP header.</div></div>
<pre><span class="METHODinput_header_field"><span class="keyword">method</span> input_header_field</span> : <code class="code">?default:string -&gt; string -&gt; string</code></pre>
<div class="info"><div class="info"><code class="code">#input_header_field ?default f</code> returns the value of a field
        <code class="code">f</code> of the HTTP request header.  The field name <code class="code">f</code> is
        case-insensitive; if the name is a compound name, the parts
        are separated by &quot;-&quot;, e.g. <code class="code">&quot;content-length&quot;</code>.  If there are
        several fields with the same name only the first field will be
        returned. <b>Raises</b> <code>Not_found</code> if the field does not exist, unless the
        <code class="code">default</code> argument is passed.  The <code class="code">default</code> argument is the
        result of the function in this case.<br/></div></div>
<pre><span class="METHODmultiple_input_header_field"><span class="keyword">method</span> multiple_input_header_field</span> : <code class="code">string -&gt; string list</code></pre>
<div class="info"><div class="info">Returns the values of all fields with the passed name of the
        request header.</div></div>
<pre><span class="METHODinput_header_fields"><span class="keyword">method</span> input_header_fields</span> : <code class="code">(string * string) list</code></pre>
<div class="info"><div class="info">Returns the input header as (name,value) pairs.  The names may
        consist of lowercase or uppercase letters.</div></div>
<pre><span class="METHODcookie"><span class="keyword">method</span> cookie</span> : <code class="code">string -&gt; <a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">Cookie.t</a></code></pre>
<div class="info"><div class="info"><code class="code">#cookie cn</code> returns the cookie with name <code class="code">cn</code>. <b>Raises</b> <code>Not_found</code> if such a cookie does not exists.<br/></div></div>
<pre><span class="METHODcookies"><span class="keyword">method</span> cookies</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">Cookie.t</a> list</code></pre>
<div class="info"><div class="info">Returns the list of valid cookies found in the request header.
        Here &quot;valid&quot; means that the decode function does not raise an
        exception.</div></div>
<pre><span class="METHODuser_agent"><span class="keyword">method</span> user_agent</span> : <code class="code">string</code></pre>
<div class="info"><div class="info">This is a convenience method that returns the <code class="code">&quot;User-agent&quot;</code>
        field of the HTTP request header.</div></div>
<pre><span class="METHODinput_content_length"><span class="keyword">method</span> input_content_length</span> : <code class="code">int</code></pre>
<div class="info"><div class="info">Returns the <code class="code">&quot;Content-length&quot;</code> request header field. <b>Raises</b> <code>Not_found</code> if it is not set.<br/></div></div>
<pre><span class="METHODinput_content_type_string"><span class="keyword">method</span> input_content_type_string</span> : <code class="code">string</code></pre>
<div class="info"><div class="info">Returns the <code class="code">&quot;Content-type&quot;</code> request header field as a plain
        string or <code class="code">&quot;&quot;</code> if it is not set.</div></div>
<pre><span class="METHODinput_content_type"><span class="keyword">method</span> input_content_type</span> : <code class="code">unit -&gt; string * (string * <a href="?package=ocamlnet&amp;module=Mimestring&amp;type=s_param">Mimestring.s_param</a>) list</code></pre>
<div class="info"><div class="info">Returns the parsed <code class="code">&quot;Content-type&quot;</code> request header field. <b>Raises</b> <code>Not_found</code> if it is not set.
        See also  <a href="#Mimestring.scan_mime_type_ep">Mimestring.scan_mime_type_ep</a>.<br/></div></div>
<div class="info"><div class="info"><h3 id="3_TITLE">Response header</h3></div></div>
<pre><span class="METHODoutput_header"><span class="keyword">method</span> output_header</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Netmime&amp;type=mime_header">Netmime.mime_header</a></code></pre>
<div class="info"><div class="info">The whole HTTP response header</div></div>
<pre><span class="METHODoutput_header_field"><span class="keyword">method</span> output_header_field</span> : <code class="code">?default:string -&gt; string -&gt; string</code></pre>
<div class="info"><div class="info">Returns the value of a field of the response header. If the
        field does not exist, <code class="code">Not_found</code> will be raised unless the
        <code class="code">default</code> argument is passed. The <code class="code">default</code> argument determines
        the result of the function in this case.<p>        If there are several fields with the same name only the first
        field will be returned.</p><p>        The anonymous string is the name of the field.  The name is
        case-insensitive, and it does not matter whether it consists
        of lowercase or uppercase letters. If the name is a compound
        name, the parts are separated by &quot;-&quot;, e.g. <code class="code">&quot;content-length&quot;</code>.</p></div></div>
<pre><span class="METHODmultiple_output_header_field"><span class="keyword">method</span> multiple_output_header_field</span> : <code class="code">string -&gt; string list</code></pre>
<div class="info"><div class="info">Returns the values of all fields with the passed name of the
        repsonse header.</div></div>
<pre><span class="METHODoutput_header_fields"><span class="keyword">method</span> output_header_fields</span> : <code class="code">(string * string) list</code></pre>
<div class="info"><div class="info">Returns the output header as (name,value) pairs.  The names may
        consist of lowercase or uppercase letters.</div></div>
<pre><span class="METHODset_output_header_field"><span class="keyword">method</span> set_output_header_field</span> : <code class="code">string -&gt; string -&gt; unit</code></pre>
<div class="info"><div class="info">Sets the value of a field of the response header.  The
        previous value, if any, is overwritten.  If there have been
        multiple values, all values will be removed and replaced by
        the single new value.</div></div>
<pre><span class="METHODset_multiple_output_header_field"><span class="keyword">method</span> set_multiple_output_header_field</span> : <code class="code">string -&gt; string list -&gt; unit</code></pre>
<div class="info"><div class="info">Sets multiple values of a field of the response header.  Any
        previous values are removed and replaced by the new values.</div></div>
<pre><span class="METHODset_output_header_fields"><span class="keyword">method</span> set_output_header_fields</span> : <code class="code">(string * string) list -&gt; unit</code></pre>
<div class="info"><div class="info">Sets the complete response header at once.</div></div>
<pre><span class="METHODset_status"><span class="keyword">method</span> set_status</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Nethttp&amp;type=http_status">Nethttp.http_status</a> -&gt; unit</code></pre>
<div class="info"><div class="info">Sets the response status.  This is by definition the same as
	setting the <code class="code">Status</code> output header field.</div></div>
<pre><span class="METHODsend_output_header"><span class="keyword">method</span> send_output_header</span> : <code class="code">unit -&gt; unit</code></pre>
<div class="info"><div class="info">This method will encode and send the output header to the
        output channel.  Note that of the output_channel is
        <code class="code">`Transactionnal</code> (as opposed to <code class="code">`Direct</code>), no output will
        actually take place before you issue <code class="code">#commit_work()</code> -- thus
        a <code class="code">#rollback_work()</code> will also rollback the headers as
        expected.</div></div>
<div class="info"><div class="info"><h3 id="3_TITLE">The output channel transferring the response</h3></div></div>
<pre><span class="METHODoutput_ch"><span class="keyword">method</span> output_ch</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Netchannels&amp;type=out_obj_channel">Netchannels.out_obj_channel</a></code></pre>
<div class="info"><div class="info"><span class="warning">Deprecated.</span> Use <code class="code">#out_channel</code> instead.<br/></div></div>
<pre><span class="METHODout_channel"><span class="keyword">method</span> out_channel</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Netchannels&amp;type=out_obj_channel">Netchannels.out_obj_channel</a></code></pre>
<div class="info"><div class="info">The &quot;raw&quot; output channel.  In general you should use instead
	 <a href="#Netcgi.cgi">Netcgi.cgi</a><code class="code">#out_channnel</code> which supports transactions (if you
	choose to).  Access to the &quot;raw&quot; channel is useful however,
	for example for sending images or download of files (for which
	transactions are not interesting but merely more work).</div></div>
<div class="info"><div class="info"><h3 id="3_TITLE">Logging</h3></div></div>
<pre><span class="METHODlog_error"><span class="keyword">method</span> log_error</span> : <code class="code">string -&gt; unit</code></pre>
<div class="info"><div class="info"><code class="code">#log_error msg</code> appends <code class="code">msg</code> to the webserver log.</div></div>
<div class="info"><div class="info"><h3 id="3_TITLE">Miscellaneous</h3></div></div>
<pre><span class="METHODconfig"><span class="keyword">method</span> config</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=config">config</a></code></pre>
<div class="info"><div class="info">The configuration of the request.</div></div></div></div>
<div class="info"><div class="info"><h2 id="2_TITLE">CGI object</h2></div></div>
<pre><span class="TYPEother_url_spec"><span class="keyword">type</span> other_url_spec</span> = <code class="type">[ `Env | `None | `This of string ]</code></pre><div class="info"><div class="info">Determines how an URL part is generated:<ul><li><code class="code">`Env</code>: Take the value from the environment.</li><li><code class="code">`This v</code>: Use this value <code class="code">v</code>. It must already be URL-encoded.</li><li><code class="code">`None</code>: Do not include this part into the URL.
    </li></ul></div></div>
<pre><span class="TYPEquery_string_spec"><span class="keyword">type</span> query_string_spec</span> = <code class="type">[ `Args of <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=rw_cgi_argument">rw_cgi_argument</a> list | `Env | `None | `This of <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a> list ]</code></pre><div class="info"><div class="info">Determines how the query part of URLs is generated:<ul><li><code class="code">`Env</code>: The query string of the current request.</li><li><code class="code">`This l</code>: The query string is created from the specified
                     argument list <code class="code">l</code>.</li><li><code class="code">`None</code>: The query string is omitted.</li><li><code class="code">`Args</code>: <i>deprecated</i>, use <code class="code">`This</code>
                   (left for backward compatibility).
    </li></ul></div></div>
<pre><span class="TYPEcache_control"><span class="keyword">type</span> cache_control</span> = <code class="type">[ `Max_age of int | `No_cache | `Unspecified ]</code></pre><div class="info"><div class="info">This is only a small subset of the HTTP 1.1 cache control
      features, but they are usually sufficient, and they work for
      HTTP/1.0 as well.  The directives mean:<p>      - <code class="code">`No_cache</code>: Caches are disabled.  The following headers are
      sent: <code class="code">Cache-control: no-cache</code>, <code class="code">Pragma: no-cache</code>, <code class="code">Expires:</code>
      (now - 1 second). Note that many versions of Internet Explorer
      have problems to process non-cached contents when TLS/SSL is
      used to transfer the file. Use <code class="code">`Max_age</code> in such cases (see
      http://support.microsoft.com/kb/316431).</p><p>      - <code class="code">`Max_age n</code>: Caches are allowed to store a copy of the
      response for <code class="code">n</code> seconds.  After that, the response must be
      revalidated.  The following headers are sent: <code class="code">Cache-control:
      max-age n</code>, <code class="code">Cache-control: must-revalidate</code>, <code class="code">Expires:</code> (now +
      <code class="code">n</code> seconds)</p><p>      - <code class="code">`Unspecified</code>: No cache control header is added to the
      response.</p><p>      Notes:</p><ul><li>Cache control directives only apply to GET requests; POST
      requests are never cached.</li><li>Not only proxies are considered as cache, but also the local
      disk cache of the browser.</li><li>HTTP/1.0 did not specify cache behaviour as strictly as
      HTTP/1.1 does.  Because of this the <code class="code">Pragma</code> and <code class="code">Expires</code>
      headers are sent, too.  These fields are not interpreted by
      HTTP/1.1 clients because <code class="code">Cache-control</code> has higher precedence.
  </li></ul></div></div>
<div class="ocaml_class sig" name="cgi"><pre><span class="TYPEcgi"><span class="keyword">class type</span> <a href="?package=ocamlnet&amp;module=Netcgi&amp;class=cgi">cgi</a></span> : <code class="code">object</code> .. <code class="code">end</code></pre><div class="info"><div class="info">Object symbolizing a CGI-like request/response cycle.<p>    This is the minimal set of services a connector must provide.
    Additional methods may be defined for specific connectors.</p></div></div><div class="ocaml_class_content"><div class="info"><div class="info"><h3 id="3_TITLE">Arguments -- data sent to the script</h3></div></div>
<pre><span class="METHODargument"><span class="keyword">method</span> argument</span> : <code class="code">string -&gt; <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a></code></pre>
<div class="info"><div class="info"><code class="code">#argument name</code> returns the value of the argument named <code class="code">name</code>.
        If the argument appears several times, only one of its
        instances is used. <b>Raises</b> <code>Not_found</code> if no such argument exists.<br/></div></div>
<pre><span class="METHODargument_value"><span class="keyword">method</span> argument_value</span> : <code class="code">?default:string -&gt; string -&gt; string</code></pre>
<div class="info"><div class="info"><code class="code">#argument_value</code> returns the value of the argument as a
        string.  If the argument does not exist, the <code class="code">default</code> is
        returned.<div class="parameters"><div class="param_info"><code class="code">default</code> : defaults to <code class="code">&quot;&quot;</code>.</div></div></div></div>
<pre><span class="METHODargument_exists"><span class="keyword">method</span> argument_exists</span> : <code class="code">string -&gt; bool</code></pre>
<div class="info"><div class="info"><code class="code">#argument_exists</code> returns <code class="code">false</code> if the named parameter is
        missing and <code class="code">true</code> otherwise.</div></div>
<pre><span class="METHODmultiple_argument"><span class="keyword">method</span> multiple_argument</span> : <code class="code">string -&gt; <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a> list</code></pre>
<div class="info"><div class="info"><code class="code">#multiple_argument name</code> returns all the values of the
	argument named <code class="code">name</code>.</div></div>
<pre><span class="METHODarguments"><span class="keyword">method</span> arguments</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a> list</code></pre>
<div class="info"><div class="info">The complete list of arguments.</div></div>
<pre><span class="METHODenvironment"><span class="keyword">method</span> environment</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_environment">cgi_environment</a></code></pre>
<div class="info"><div class="info">The environment object.  This object is the &quot;outer layer&quot; of the
        activation object that connects it with real I/O channels.</div></div>
<pre><span class="METHODrequest_method"><span class="keyword">method</span> request_method</span> : <code class="code">[ `DELETE | `GET | `HEAD | `POST | `PUT of <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_argument">cgi_argument</a> ]</code></pre>
<div class="info"><div class="info">The HTTP method used to make the request.</div></div>
<pre><span class="METHODfinalize"><span class="keyword">method</span> finalize</span> : <code class="code">unit -&gt; unit</code></pre>
<div class="info"><div class="info">This method calls <code class="code">#finalize</code> for every CGI argument
        (including the possible one of PUT) to ensure that all files
        are deleted.  It also executes all functions registered with
        <code class="code">#at_exit</code>.  It does not close the in/out channels, however.
        This method is not registered in the garbage collector, and it
        is a bad idea to do so.  However, all connectors offered in
        Netcgi automatically call <code class="code">#finalize</code> at the end of the
        request cycle (even when its terminated by an uncaught exception
        when <code class="code">#config.default_exn_handler</code> is true) so you do not have
        to worry much about calling it yourself.</div></div>
<div class="info"><div class="info"><h3 id="3_TITLE">Self-referencing URL</h3></div></div>
<pre><span class="METHODurl"><span class="keyword">method</span> url</span> : <code class="code">?protocol:<a href="?package=ocamlnet&amp;module=Nethttp&amp;type=protocol">Nethttp.protocol</a> -&gt;
?with_authority:<a href="?package=ocamlnet&amp;module=Netcgi&amp;type=other_url_spec">other_url_spec</a> -&gt;
?with_script_name:<a href="?package=ocamlnet&amp;module=Netcgi&amp;type=other_url_spec">other_url_spec</a> -&gt;
?with_path_info:<a href="?package=ocamlnet&amp;module=Netcgi&amp;type=other_url_spec">other_url_spec</a> -&gt;
?with_query_string:<a href="?package=ocamlnet&amp;module=Netcgi&amp;type=query_string_spec">query_string_spec</a> -&gt; unit -&gt; string</code></pre>
<div class="info"><div class="info">Returns the URL of the current CGI-like script.  (Note that it
	may differ from the actual URL that requested the script if,
	for example, rewriting rules were specified in the web server
	configuration.)<div class="parameters"><div class="param_info"><code class="code">protocol</code> : The URL scheme.  By default, the URL scheme is
        used that is described in the environment</div><div class="param_info"><code class="code">with_authority</code> : Whether to include authority part
        (e.g. http or https) of the URL, and if yes, from which
        source.  Default: <code class="code">`Env</code>.</div><div class="param_info"><code class="code">with_script_name</code> : Whether to include the part of the URL
        path identifying the CGI script, and if yes, from which
        source.  Default: <code class="code">`Env</code>.</div><div class="param_info"><code class="code">with_path_info</code> : Whether to include the rest of the URL
        path exceeding the script name, and if yes, from which source.
        Default: <code class="code">`Env</code>.</div><div class="param_info"><code class="code">with_query_string</code> : Whether to include a query string,
        and if yes, which one.  Only arguments with <code class="code">#store</code> being
        <code class="code">`Memory</code> will be added.  Default: <code class="code">`None</code>, i.e. no query
        string.</div></div></div></div>
<div class="info"><div class="info"><h3 id="3_TITLE">Outputting</h3></div></div>
<pre><span class="METHODset_header"><span class="keyword">method</span> set_header</span> : <code class="code">?status:<a href="?package=ocamlnet&amp;module=Nethttp&amp;type=http_status">Nethttp.http_status</a> -&gt;
?content_type:string -&gt;
?content_length:int -&gt;
?set_cookie:<a href="?package=ocamlnet&amp;module=Nethttp&amp;type=cookie">Nethttp.cookie</a> list -&gt;
?set_cookies:<a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">Cookie.t</a> list -&gt;
?cache:<a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cache_control">cache_control</a> -&gt;
?filename:string -&gt;
?language:string -&gt;
?script_type:string -&gt;
?style_type:string -&gt; ?fields:(string * string list) list -&gt; unit -&gt; unit</code></pre>
<div class="info"><div class="info">Sets the header (removing any previous one).  When the output
        channel supports transactions, it is possible to set the
        header (possibly several times) until the <code class="code">#out_channel</code> is
        commited for the first time or <code class="code">#env#send_output_header()</code> is
        called.  When there is no support for transactions, the header
        must be set before the first byte of output is written.<p>        If <code class="code">#set_header</code> is called a second time, it will overwrite
        <i>all</i> the header fields.</p><div class="parameters"><div class="param_info"><code class="code">status</code> : Sets the HTTP status of the reply according to
	 <a href="http://www.w3.org/Protocols/rfc2616">RFC 2616</a>.  Defaults to
	&quot;no status&quot;, but the server normally complements an <code class="code">`Ok</code>
	status in this case.</div><div class="param_info"><code class="code">content_type</code> : Sets the content type.
	Defaults to <code class="code">&quot;text/html&quot;</code>.</div><div class="param_info"><code class="code">content_length</code> : Sets the content length (in bytes).
	Default: No such field.</div><div class="param_info"><code class="code">set_cookie</code> : Deprecated, use <code class="code">set_cookies</code>.</div><div class="param_info"><code class="code">set_cookies</code> : Sets a number of cookies.  Default: <code class="code">[]</code>.
	Remember that the browser may not support more than 20 cookies
	per web server.  You can query the cookies using <code class="code">env#cookies</code>
	and <code class="code">env#cookie</code>.  If you set cookies, you want to think about
	an appropriate <code class="code">cache</code> setting.  You may also want to add a
	 <a href="http://www.w3.org/P3P/">P3P</a> header (Platform for Privacy
	Preferences) -- otherwise your cookies may be discarded by
	some browsers.</div><div class="param_info"><code class="code">cache</code> : Sets the cache behavior for replies to GET
        requests.  The default is <code class="code">`Unspecified</code>.  <b>It is strongly
        recommended to specify the caching behaviour!!!</b> You are on
        the safe side with <code class="code">`No_cache</code>, forcing every page to be
        regenerated. If your data do not change frequently, <code class="code">`Max_age
        n</code> tells the caches to store the data at most <code class="code">n</code> seconds.</div><div class="param_info"><code class="code">filename</code> : Sets the filename associated with the page.
        This filename is taken for the &quot;save as...&quot;  dialog.  Default:
        <code class="code">&quot;&quot;</code>, i.e. no filename.  Note: It is bad practice if the
        filename contains problematic characters (backslash, double
        quote, space), or the names of directories.  It is recommended
        that you set <code class="code">content_type</code> to &quot;application/octet-stream&quot; for
        this feture to work with most browsers and, if possible, to
        set <code class="code">content_length</code> because that usually improves the
        download dialog.)</div><div class="param_info"><code class="code">script_type</code> : Sets the language of the script tag (for
        HTML replies).  It is recommended to use this field if there
        are <code class="code">ONXXX</code> attributes containing scripts before the first
        <code class="code">&lt;SCRIPT&gt;</code> element, because you cannot specify the script
        language for the <code class="code">ONXXX</code> attributes otherwise.  <code class="code">script_type</code>
        must be a media type, e.g. &quot;text/javascript&quot;.  Default: no
        language is specified.</div><div class="param_info"><code class="code">style_type</code> : Sets the language of the style tag (for
        HTML replies).  It is recommended to use this field if there
        are <code class="code">STYLE</code> attributes containing scripts before the first
        <code class="code">&lt;STYLE&gt;</code> element, because you cannot specify the style
        language for the <code class="code">STYLE</code> attributes otherwise.  <code class="code">style_type</code>
        must be a media type, e.g. &quot;text/css&quot;.  Default: no language
        is specified.</div><div class="param_info"><code class="code">fields</code> : Sets additional fields of the header.  Default: <code class="code">[]</code>.</div></div></div></div>
<pre><span class="METHODset_redirection_header"><span class="keyword">method</span> set_redirection_header</span> : <code class="code">?set_cookies:<a href="?package=ocamlnet&amp;module=Netcgi.Cookie&amp;type=t">Cookie.t</a> list -&gt;
?fields:(string * string list) list -&gt; string -&gt; unit</code></pre>
<div class="info"><div class="info">Sets the header such that a redirection to the specified URL
        is performed.  If the URL begins with &quot;http:&quot; the redirection
        directive is passed back to the client, and the client will
        repeat the request for the new location (with a GET method).
        If the URL begins with &quot;/&quot;, the server performs the
        redirection, and it is invisible for the client.</div></div>
<pre><span class="METHODoutput"><span class="keyword">method</span> output</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Netchannels&amp;type=trans_out_obj_channel">Netchannels.trans_out_obj_channel</a></code></pre>
<div class="info"><div class="info"><span class="warning">Deprecated.</span> Use <code class="code">#out_channel</code> instead.<br/></div></div>
<pre><span class="METHODout_channel"><span class="keyword">method</span> out_channel</span> : <code class="code"><a href="?package=ocamlnet&amp;module=Netchannels&amp;type=trans_out_obj_channel">Netchannels.trans_out_obj_channel</a></code></pre>
<div class="info"><div class="info">The output channel to which the generated content is intended
        to be written.  The header is not stored in this channel, so
        <code class="code">#pos_out</code> returns the size of the DATA in bytes (useful to
        set Content-Length).  Note that HEAD requests must not send
        back a message body so, in this case, all data sent to this
        channel is discarded.  This allows your scripts to work
        unmodified for GET, POST and HEAD requests.<p>        The output channel may have transactional semantics, and
        because of this, it is an <code class="code">trans_out_obj_channel</code>.
        Implementations are free to support transactions or not.</p><p>        After all data have been written, the method <code class="code">#commit_work()</code>
        <b>must</b> be called, even if there is no support for
        transactions.</p><p>        Simple Example:
        </p><code class="code">
        cgi # out_channel # output_string &quot;Hello world!\n&quot;;
        cgi # out_channel # commit_work()
        </code><p>        Example for an error handler and a transaction buffer: If an
        error happens, it is possible to roll the channel back, and to
        write the error message.
        </p><code class="code">
        try
          cgi # set_header ... ();
          cgi # out_channel # output_string &quot;Hello World!&quot;; ...
          cgi # out_channel # commit_work();
        with err -&gt;
          cgi # out_channel # rollback_work();
          cgi # set_header ... ();
          cgi # out_channel # output_string &quot;Software error!&quot;; ...
          cgi # out_channel # commit_work();
        </code></div></div>
<pre><span class="METHODat_exit"><span class="keyword">method</span> at_exit</span> : <code class="code">(unit -&gt; unit) -&gt; unit</code></pre>
<div class="info"><div class="info"><code class="code">#at_exit f</code> registers the function <code class="code">f</code> to be executed when
	<code class="code">#finalize</code> is called (which is done automatically when the
	request finishes).  The functions are executed in the reverse
	order in which they were registered.</div></div></div></div>
<div class="ocaml_class ident" name="cgi_activation" path="?package=ocamlnet&amp;module=Netcgi&amp;class=cgi"><pre><span class="TYPEcgi_activation"><span class="keyword">class type</span> <a href="?package=ocamlnet&amp;module=Netcgi&amp;class=cgi_activation">cgi_activation</a></span> : <code class="type"/><a href="?package=ocamlnet&amp;module=Netcgi&amp;class=cgi">cgi</a></pre><div class="info"><div class="info">Alternate, more descriptive name for <code class="code">cgi</code></div></div></div>
<div class="info"><div class="info"><h2 id="2_TITLE">Connectors</h2></div></div>
<pre><span class="TYPEoutput_type"><span class="keyword">type</span> output_type</span> = <code class="type">[ `Direct of string
| `Transactional of
    <a href="?package=ocamlnet&amp;module=Netcgi&amp;type=config">config</a> -&gt;
    <a href="?package=ocamlnet&amp;module=Netchannels&amp;type=out_obj_channel">Netchannels.out_obj_channel</a> -&gt; <a href="?package=ocamlnet&amp;module=Netchannels&amp;type=trans_out_obj_channel">Netchannels.trans_out_obj_channel</a> ]</code></pre><div class="info"><div class="info">The ouput type determines how generated data is buffered.<ul><li><code class="code">`Direct sep</code>: Data written to the output channel of the
        activation object is not collected in a transaction buffer, but
        directly sent to the browser (the normal I/O buffering is still
        active, however, so call <code class="code">#flush</code> to ensure that data is really
        sent).  The method <code class="code">#commit_work</code> of the output channel is the
        same as <code class="code">#flush</code>.  The method <code class="code">#rollback_work</code> causes that the
        string <code class="code">sep</code> is sent, meant as a separator between the already
        generated output, and the now following error message.</li></ul>      - <code class="code">`Transactional f</code>: A transactional channel <code class="code">tc</code> is created
        from the real output channel <code class="code">ch</code> by calling <code class="code">f cfg ch</code> (here,
        <code class="code">cfg</code> is the CGI configuration).  The channel <code class="code">tc</code> is propagated
        as the output channel of the activation object. This means that
        the methods <code class="code">commit_work</code> and <code class="code">rollback_work</code> are implemented by
        <code class="code">tc</code>, and the intended behaviour is that data is buffered in a
        special transaction buffer until <code class="code">commit_work</code> is called.  This
        invocation forces the buffered data to be sent to the
        browser. If, however, <code class="code">rollback_work</code> is called, the buffer is
        cleared.<p>      Two important examples for <code class="code">`Transactional</code> are:</p><ul><li>The transaction buffer is implemented in memory:
      <code class="code">
      let buffered _ ch = new Netchannels.buffered_trans_channel ch in
      `Transactional buffered
      </code></li><li>The transaction buffer is implemented as an external file:
      <code class="code">
      `Transactional(fun _ ch -&gt; new Netchannels.tempfile_output_channel ch)
      </code>
  </li></ul></div></div>
<pre><span class="VALbuffered_transactional_outtype"><span class="keyword">val</span> buffered_transactional_outtype</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=output_type">output_type</a></code></pre><div class="info"><div class="info">The <code class="code">output_type</code> implementing transactions with a RAM-based buffer</div></div>
<pre><span class="VALbuffered_transactional_optype"><span class="keyword">val</span> buffered_transactional_optype</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=output_type">output_type</a></code></pre><div class="info"><div class="info"><b>Deprecated</b> name for <code class="code">buffered_transactional_outtype</code></div></div>
<pre><span class="VALtempfile_transactional_outtype"><span class="keyword">val</span> tempfile_transactional_outtype</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=output_type">output_type</a></code></pre><div class="info"><div class="info">The <code class="code">output_type</code> implementing transactions with a tempfile-based
      buffer</div></div>
<pre><span class="VALtempfile_transactional_optype"><span class="keyword">val</span> tempfile_transactional_optype</span> : <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=output_type">output_type</a></code></pre><div class="info"><div class="info"><b>Deprecated</b> name for <code class="code">tempfile_transactional_outtype</code></div></div>
<pre><span class="TYPEarg_store"><span class="keyword">type</span> arg_store</span> = <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_environment">cgi_environment</a> -&gt;
string -&gt;
<a href="?package=ocamlnet&amp;module=Netmime&amp;type=mime_header_ro">Netmime.mime_header_ro</a> -&gt;
[ `Automatic
| `Automatic_max of float
| `Discard
| `File
| `File_max of float
| `Memory
| `Memory_max of float ]</code></pre><div class="info"><div class="info">This is the type of functions <code class="code">arg_store</code> so that <code class="code">arg_store env
        name header</code> tells whether to <code class="code">`Discard</code> the argument or to
        store it into a <code class="code">`File</code> or in <code class="code">`Memory</code>.  The parameters passed
        to <code class="code">arg_store</code> are as follows:<p>        - <code class="code">env</code> is the CGI environment.  Thus, for example, you can have
        different policies for different <code class="code">cgi_path_info</code>.</p><p>        - <code class="code">name</code> is the name of the argument.</p><p>        - <code class="code">header</code> is the MIME header of the argument (if any).</p><p>        Any exception raised by <code class="code">arg_store</code> will be treated like if it
        returned <code class="code">`Discard</code>.  Note that the <code class="code">`File</code> will be treated
        like <code class="code">`Memory</code> except for <code class="code">`POST</code> &quot;multipart/form-data&quot; and
        <code class="code">`PUT</code> queries.</p><p>        <code class="code">`Automatic</code> means to store it into a file if the header
        contains a file name and otherwise in memory (strictly
        speaking <code class="code">`Automatic</code> is not necessary since <code class="code">arg_store</code> can
        check the header but is provided for your convenience).</p><p>        <code class="code">`Memory_max</code> (resp. <code class="code">`File_max</code>, resp. <code class="code">`Automatic_max</code>) is
        the same as <code class="code">`Memory</code> (resp. <code class="code">`File</code>, resp. <code class="code">`Automatic</code>)
        except that the parameter indicates the maximum size in kB of
        the argument value.  If the size is bigger, the
         <a href="#Netcgi.cgi_argument">Netcgi.cgi_argument</a> methods <code class="code">#value</code> and <code class="code">#open_value_rd</code>
        methods will raise  <a href="#Netcgi.Argument.Oversized">Netcgi.Argument.Oversized</a>.</p><p>        Remark: this allows for fine grained size constraints while
         <a href="#Netcgi.config">Netcgi.config</a><code class="code">.input_content_length_limit</code> option is a
        limit on the size of the entire request.</p></div></div>
<pre><span class="TYPEexn_handler"><span class="keyword">type</span> exn_handler</span> = <code class="type"><a href="?package=ocamlnet&amp;module=Netcgi&amp;type=cgi_environment">cgi_environment</a> -&gt; (unit -&gt; unit) -&gt; unit</code></pre><div class="info"><div class="info">A function of type <code class="code">exn_handler</code> allows to define a custom
      handler of uncaught exceptions raised by the <code class="code">unit -&gt; unit</code>
      parameter.  A typical example of <code class="code">exn_handler</code> is as follows:
      <code class="code">
      let exn_handler env f =
        try f()
        with
        | Exn1 -&gt; (* generate error page *)
            env#set_output_header_fields [...];
            env#send_output_header();
            env#out_channel#output_string &quot;...&quot;;
            env#out_channel#close_out()
        | ...
      </code></div></div>
<pre><span class="TYPEconnection_directive"><span class="keyword">type</span> connection_directive</span> = <code class="type">[ `Conn_close | `Conn_close_linger | `Conn_error of exn | `Conn_keep_alive ]</code></pre><div class="info"><div class="info">Directive how to go on with the current connection:<ul><li><code class="code">`Conn_close</code>: Just shut down and close descriptor</li><li><code class="code">`Conn_close_linger</code>: Linger, shut down, and close descriptor</li><li><code class="code">`Conn_keep_alive</code>: Check for another request on the same connection</li><li><code class="code">`Conn_error e</code>: Shut down and close descriptor, and handle the
   exception <code class="code">e</code>
   </li></ul></div></div>
<div class="info"><div class="info">Specific connectors can be found in separate modules.  For example:<p>    -  <a href="#Netcgi_cgi">Netcgi_cgi</a>:  classical CGI.</p><ul><li> <a href="#Netcgi_fcgi">Netcgi_fcgi</a>: FastCGI protocol.</li><li> <a href="#Netcgi_ajp">Netcgi_ajp</a>:  AJP 1.3 connector (JSERV protocol).</li><li> <a href="#Netcgi_mod">Netcgi_mod</a>:  connector binding to Apache API.</li><li> <a href="#Netcgi_scgi">Netcgi_scgi</a>: SCGI connector.</li><li> <a href="#Netcgi_test">Netcgi_test</a>: special &quot;connector&quot; to test your code.</li></ul>    A typical use is as follows:
    <code class="code">
    open Netcgi

    let main (cgi:cgi) =
       let arg = cgi#argument_value &quot;name&quot; in
       ...
       cgi#out_channel#commit_work()

    let () =
      let buffered _ ch = new Netchannels.buffered_trans_channel ch in
      Netcgi_cgi.run ~output_type:(`Transactional buffered) main
    </code></div></div>
</div>